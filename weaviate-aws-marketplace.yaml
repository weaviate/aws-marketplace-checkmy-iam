---
ACTIONS:
  # Cloudformation
  - cloudformation:CreateStack
  - cloudformation:UpdateStac
  - cloudformation:DeleteStack
  # IAM Related
  - iam:PassRole
  - sts:AssumeRole
  - sts:AssumeRoleWithWebIdentity
  # VPC Related
  - ec2:CreateVpc
  - ec2:CreateSubnet
  - ec2:DescribeAvailabilityZones
  - ec2:CreateRouteTable
  - ec2:CreateRoute
  - ec2:CreateInternetGateway
  - ec2:AttachInternetGateway
  - ec2:AssociateRouteTable
  - ec2:ModifyVpcAttribute
  # EC2 Instance Related
  - ec2:CreateTags
  - ec2:DeleteTags
  # EKS related
  - eks:ListNodegroups
  - eks:DescribeFargateProfile
  - eks:ListTagsForResource
  - eks:ListAddons
  - eks:DescribeAddon
  - eks:ListFargateProfiles
  - eks:DescribeNodegroup
  - eks:ListUpdates
  - eks:DescribeUpdate
  - eks:AccessKubernetesApi
  - eks:DescribeCluster
  - eks:ListClusters
  - eks:DescribeAddonVersions
  # KMS
  - kms:*
  - kms:CreateGrant
  - kms:Decrypt
  - kms:DescribeKey
  - kms:Encrypt
  # Logs
  - logs:CreateLogStream
  - logs:DescribeLogStreams
  - logs:PutLogEvents
  # Main actions coming from EKS, Marketplace
  - iam:AddClientIDToOpenIDConnectProvider
  - iam:CreateOpenIDConnectProvider
  - iam:DeleteOpenIDConnectProvider
  - iam:RemoveClientIDFromOpenIDConnectProvider
  - iam:UpdateOpenIDConnectProviderThumbprint
  - ec2:DescribeDhcpOptions
  - ec2:DescribeInstances
  - ec2:DescribeNetworkInterfaces
  - ec2:DescribeRouteTables
  - ec2:DescribeSecurityGroups
  - ec2:DescribeSubnets
  - ec2:DescribeVpcs
  - eks:CreateCluster
  - eks:CreateFargateProfile
  - eks:DeleteCluster
  - eks:DeleteFargateProfile
  - eks:DescribeCluster
  - eks:DescribeFargateProfile
  - eks:DescribeUpdate
  - eks:TagResource
  - eks:UntagResource
  - eks:UpdateClusterConfig
  - eks:UpdateClusterVersion
  - iam:CreateServiceLinkedRole
  - iam:GetRole
  - iam:listAttachedRolePolicies
  - eks:AccessKubernetesApi
  - eks:DescribeAddonVersions
  - eks:DescribeCluster
  - eks:DescribeNodegroup
  - eks:ListAddons
  - eks:ListClusters
  - eks:ListFargateProfiles
  - eks:ListIdentityProviderConfigs
  - eks:ListNodegroups
  - eks:ListUpdates
  - iam:ListRoles
  - ec2:AuthorizeSecurityGroupIngress
  - ec2:DeleteSecurityGroup
  - ec2:RevokeSecurityGroupIngress
  - acm:DescribeCertificate
  - acm:ListCertificates
  - cognito-idp:DescribeUserPoolClient
  - ec2:AuthorizeSecurityGroupIngress
  - ec2:CreateSecurityGroup
  - ec2:DescribeAccountAttributes
  - ec2:DescribeAddresses
  - ec2:DescribeAvailabilityZones
  - ec2:DescribeCoipPools
  - ec2:DescribeInstances
  - ec2:DescribeInternetGateways
  - ec2:DescribeNetworkInterfaces
  - ec2:DescribeSecurityGroups
  - ec2:DescribeSubnets
  - ec2:DescribeTags
  - ec2:DescribeVpcPeeringConnections
  - ec2:DescribeVpcs
  - ec2:GetCoipPoolUsage
  - ec2:RevokeSecurityGroupIngress
  - iam:GetServerCertificate
  - iam:ListServerCertificates
  - shield:CreateProtection
  - shield:DeleteProtection
  - shield:DescribeProtection
  - shield:GetSubscriptionState
  - waf-regional:AssociateWebACL
  - waf-regional:DisassociateWebACL
  - waf-regional:GetWebACL
  - waf-regional:GetWebACLForResource
  - wafv2:AssociateWebACL
  - wafv2:DisassociateWebACL
  - wafv2:GetWebACL
  - wafv2:GetWebACLForResource
  - iam:CreateServiceLinkedRole
  - ec2:DescribeAvailabilityZones
  - ec2:DescribeInstances
  - ec2:DescribeSnapshots
  - ec2:DescribeTags
  - ec2:DescribeVolumes
  - ec2:DescribeVolumesModifications
  - ec2:CreateSnapshot
  - ec2:CreateVolume
  - ec2:AttachVolume
  - ec2:DeleteSnapshot
  - ec2:DeleteVolume
  - ec2:DetachVolume
  - ec2:ModifyVolume
  - aws-marketplace:BatchMeterUsage
  - aws-marketplace:GetEntitlements
  - aws-marketplace:MeterUsage
  - aws-marketplace:ResolveCustomer
  - ec2:DescribeInstanceTypes
  - ec2:DescribeInstances
  - eks:DescribeNodegroup
  # security group related
  - ec2:AuthorizeSecurityGroupEgress
  - ec2:AuthorizeSecurityGroupIngress
  - ec2:RevokeSecurityGroupEgress
  - ec2:RevokeSecurityGroupIngress
  # misc based on research from the cdk generated stack
  - ssm:GetParameter
  # ingress related
  - elasticloadbalancing:AddTags
  - elasticloadbalancing:RemoveTags
  - elasticloadbalancing:DeregisterTargets
  - elasticloadbalancing:RegisterTargets
  - elasticloadbalancing:ModifyLoadBalancerAttributes
  - elasticloadbalancing:ModifyTargetGroup
  - elasticloadbalancing:ModifyTargetGroupAttributes
  - elasticloadbalancing:SetIpAddressType
  - elasticloadbalancing:SetSecurityGroups
  - elasticloadbalancing:SetSubnets
  - elasticloadbalancing:CreateLoadBalancer
  - elasticloadbalancing:CreateTargetGroup
  - elasticloadbalancing:DeleteLoadBalancer
  - elasticloadbalancing:DeleteTargetGroup
  - elasticloadbalancing:AddListenerCertificates
  - elasticloadbalancing:AddTags
  - elasticloadbalancing:CreateListener
  - elasticloadbalancing:CreateRule
  - elasticloadbalancing:DeleteListener
  - elasticloadbalancing:DeleteRule
  - elasticloadbalancing:DescribeListenerCertificates
  - elasticloadbalancing:DescribeListeners
  - elasticloadbalancing:DescribeLoadBalancerAttributes
  - elasticloadbalancing:DescribeLoadBalancers
  - elasticloadbalancing:DescribeRules
  - elasticloadbalancing:DescribeSSLPolicies
  - elasticloadbalancing:DescribeTags
  - elasticloadbalancing:DescribeTargetGroupAttributes
  - elasticloadbalancing:DescribeTargetGroups
  - elasticloadbalancing:DescribeTargetHealth
  - elasticloadbalancing:ModifyListener
  - elasticloadbalancing:ModifyRule
  - elasticloadbalancing:RemoveListenerCertificates
  - elasticloadbalancing:RemoveTags
  - elasticloadbalancing:SetWebAcl
RESOURCES: []
